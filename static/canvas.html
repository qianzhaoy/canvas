<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>多人协同白板设计</title>
<!--    <script type="text/javascript" src="https://cdn.socket.io/socket.io-1.3.5.js"></script>-->
    <script type="text/javascript" src="jquery-1.11.1.min.js"></script>
    <style type="text/css">
        .left {
            float: left
        }
        #can{
            border: 1px solid #000;
            cursor: crosshair
        }
        .right {
            float: left
        }
        .right>ul>li{
            margin:10px 0;
        }
    </style>

    <script type="text/javascript">
        //var socket = io();

    </script>
</head>

<body>
    <div class="left">
        <canvas id="can" height="600" width="800">您的浏览器不支持绘图</canvas>
    </div>
    <div class="right">
        <ul>
           <li>
               <button id="clear">清除</button>
           </li>
            <li>
                <label for="color">选择线条颜色: </label>
                <input type="color" id="color">
            </li>
            <li>
                <label for="lineWidth">选择线条线宽: </label>
                <input type="number" id="lineWidth" min="1" value="1">
            </li>  
            <li>
                <label for="lineWidth">选择线条线型: </label>
                <select name="type" id="lineType">
                    <option value="0">任意线条</option>
                    <option value="1">直线</option>
                </select>
            </li>
        </ul>
    </div>
    <script type="text/javascript">
        var canvas = document.getElementById('can');
        var ctx = canvas.getContext('2d');
        var color = '';
        var lineWidth = 1;
        var pathArr = [];
        var canvasFn = function(event) {
                var q = event.pageX - 8;
                var p = event.pageY - 8;
                var qp = {
                    'hoverX': q,
                    'hoverY': p
                }
              //  socket.emit('path', qp);
                ctx.lineWidth = lineWidth;
                ctx.lineTo(q, p);
                ctx.strokeStyle = color;
                ctx.stroke();
            };
        var lineFn = function (event) {
            
        }
        var mouseFn = canvasFn;
        $("#color").change(function() {
            var mycolor = $('input').val();
            color = mycolor;
            socket.emit('color', mycolor);
        })
        $("#lineWidth").change(function() {
            var width = $(this).val();
            lineWidth = Number(width);
        //    socket.emit('lineWidth', width);
        })
        $("#lineType").change(function (eve) {
            var type = $(this).val();
            switch (type){
                case '0':
                    mouseFn = canvas;
                    break;
                case '1':
                    mouseFn = lineFn;
                    break;
            }
        })
        $(canvas).mousedown(function(event) {

            var x = event.pageX - 8;// - 8 为了修正轨迹坐标
            var y = event.pageY - 8;
            var xy = {
                'startX': x,
                'startY': y
            };
           // socket.emit('start', xy);
            ctx.beginPath();
            ctx.moveTo(x, y);

            $(canvas).mousemove(mouseFn);
        });
        $(canvas).mouseup(function() {
            $(this).unbind('mousemove')
        })
        
        $("#clear").click(function () {
            pathArr = [];
            ctx.clearRect(0,0,canvas.width,canvas.height);
        })
    </script>


</body>

</html>
